<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flowchart Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: 'Raleway', sans-serif;
            background-color: rgba(26, 26, 46, 0.9);
            color: #ffffff;
            overflow: hidden;
        }

        #vanta-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }

        h1 {
            font-size: 3.5rem;
            color: #e94560; 
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        #topic-input {
            width: 80%;
            max-width: 500px;
            padding: 15px;
            border: none;
            border-radius: 50px;
            background-color: rgba(255, 255, 255, 0.2);
            color: #ffffff;
            font-size: 1.2rem;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        #topic-input:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.5);
            transform: scale(1.05);
        }

        #generate-btn {
            background: linear-gradient(45deg, #e94560, #0f3460);
            color: #ffffff;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.2rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #generate-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
        }

        #flowchart-container {
            width: 90%;
            height: 60vh;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            margin-top: 30px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            display: none;
            backdrop-filter: blur(5px);
            position: relative; 
        }

        #flowchart {
            width: 100%;
            height: 100%;
        }

        #loading-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            display: none;
        }

        /* Cool Loader Styles */
        .loader {
            border: 8px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 8px solid #e94560;
            width: 80px;
            height: 80px;
            animation: spin 1.5s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        #error-message {
            color: #e94560;
            text-align: center;
            margin-top: 20px;
            display: none;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Fullscreen Button Styles */
        #fullscreen-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e94560;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            padding: 10px;
            cursor: pointer;
            font-size: 16px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }

            #topic-input {
                width: 90%;
            }
        }
    </style>
</head>
<body>
    <div id="vanta-background"></div>
    <div class="container">
        <h1>Flowchart Generator</h1>
        <input type="text" id="topic-input" placeholder="Enter topic or algorithm name" required>
        <button id="generate-btn">Generate</button>
        <div id="flowchart-container">
            <div id="flowchart"></div>
            <div id="loading-animation">
                <div class="loader"></div>
            </div>
            <button id="fullscreen-btn">Fullscreen</button>
        </div>
        <div id="error-message"></div>
        <div class="translator-container">
            <h3>Translate AI Output</h3>
            <div class="translator-controls">
                <select id="languageSelect" class="language-select">
                    <option value="af">Afrikaans</option>
                    <option value="sq">Albanian</option>
                    <option value="am">Amharic</option>
                    <option value="ar">Arabic</option>
                    <option value="hy">Armenian</option>
                    <option value="az">Azerbaijani</option>
                    <option value="eu">Basque</option>
                    <option value="be">Belarusian</option>
                    <option value="bn">Bengali</option>
                    <option value="bs">Bosnian</option>
                    <option value="bg">Bulgarian</option>
                    <option value="ca">Catalan</option>
                    <option value="ceb">Cebuano</option>
                    <option value="ny">Chichewa</option>
                    <option value="zh-CN">Chinese (Simplified)</option>
                    <option value="zh-TW">Chinese (Traditional)</option>
                    <option value="co">Corsican</option>
                    <option value="hr">Croatian</option>
                    <option value="cs">Czech</option>
                    <option value="da">Danish</option>
                    <option value="nl">Dutch</option>
                    <option value="en">English</option>
                    <option value="eo">Esperanto</option>
                    <option value="et">Estonian</option>
                    <option value="tl">Filipino</option>
                    <option value="fi">Finnish</option>
                    <option value="fr">French</option>
                    <option value="fy">Frisian</option>
                    <option value="gl">Galician</option>
                    <option value="ka">Georgian</option>
                    <option value="de">German</option>
                    <option value="el">Greek</option>
                    <option value="gu">Gujarati</option>
                    <option value="ht">Haitian Creole</option>
                    <option value="ha">Hausa</option>
                    <option value="haw">Hawaiian</option>
                    <option value="iw">Hebrew</option>
                    <option value="hi">Hindi</option>
                    <option value="hmn">Hmong</option>
                    <option value="hu">Hungarian</option>
                    <option value="is">Icelandic</option>
                    <option value="ig">Igbo</option>
                    <option value="id">Indonesian</option>
                    <option value="ga">Irish</option>
                    <option value="it">Italian</option>
                    <option value="ja">Japanese</option>
                    <option value="jw">Javanese</option>
                    <option value="kn">Kannada</option>
                    <option value="kk">Kazakh</option>
                    <option value="km">Khmer</option>
                    <option value="ko">Korean</option>
                    <option value="ku">Kurdish (Kurmanji)</option>
                    <option value="ky">Kyrgyz</option>
                    <option value="lo">Lao</option>
                    <option value="la">Latin</option>
                    <option value="lv">Latvian</option>
                    <option value="lt">Lithuanian</option>
                    <option value="lb">Luxembourgish</option>
                    <option value="mk">Macedonian</option>
                    <option value="mg">Malagasy</option>
                    <option value="ms">Malay</option>
                    <option value="ml">Malayalam</option>
                    <option value="mt">Maltese</option>
                    <option value="mi">Maori</option>
                    <option value="mr">Marathi</option>
                    <option value="mn">Mongolian</option>
                    <option value="my">Myanmar (Burmese)</option>
                    <option value="ne">Nepali</option>
                    <option value="no">Norwegian</option>
                    <option value="ps">Pashto</option>
                    <option value="fa">Persian</option>
                    <option value="pl">Polish</option>
                    <option value="pt">Portuguese</option>
                    <option value="pa">Punjabi</option>
                    <option value="ro">Romanian</option>
                    <option value="ru">Russian</option>
                    <option value="sm">Samoan</option>
                    <option value="gd">Scots Gaelic</option>
                    <option value="sr">Serbian</option>
                    <option value="st">Sesotho</option>
                    <option value="sn">Shona</option>
                    <option value="sd">Sindhi</option>
                    <option value="si">Sinhala</option>
                    <option value="sk">Slovak</option>
                    <option value="sl">Slovenian</option>
                    <option value="so">Somali</option>
                    <option value="es">Spanish</option>
                    <option value="su">Sundanese</option>
                    <option value="sw">Swahili</option>
                    <option value="sv">Swedish</option>
                    <option value="tg">Tajik</option>
                    <option value="ta">Tamil</option>
                    <option value="te">Telugu</option>
                    <option value="th">Thai</option>
                    <option value="tr">Turkish</option>
                    <option value="uk">Ukrainian</option>
                    <option value="ur">Urdu</option>
                    <option value="uz">Uzbek</option>
                    <option value="vi">Vietnamese</option>
                    <option value="cy">Welsh</option>
                    <option value="xh">Xhosa</option>
                    <option value="yi">Yiddish</option>
                    <option value="yo">Yoruba</option>
                    <option value="zu">Zulu</option>
                </select>
                <button id="translateBtn" class="translate-btn">Translate</button>
            </div>
            <div id="translatedOutput" class="translated-output">
                <!-- Translated output will be displayed here -->
            </div>
        </div>

        <style>
            .translator-container {
                margin-top: 30px;
                padding: 30px;
                background-color: rgba(255, 255, 255, 0.05);
                border-radius: 15px;
                box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
                backdrop-filter: blur(4px);
                -webkit-backdrop-filter: blur(4px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }

            .translator-container h3 {
                color: #e94560;
                margin-bottom: 20px;
                font-size: 1.8rem;
                text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            }

            .translator-controls {
                display: flex;
                gap: 15px;
                margin-bottom: 20px;
            }

            .language-select {
                flex-grow: 1;
                padding: 12px;
                border: none;
                border-radius: 8px;
                background-color: rgba(255, 255, 255, 0.1);
                color: #000000;
                font-size: 16px;
                transition: all 0.3s ease;
            }

            .language-select:focus {
                outline: none;
                box-shadow: 0 0 0 2px rgba(233, 69, 96, 0.5);
            }

            .translate-btn {
                padding: 12px 25px;
                border: none;
                border-radius: 8px;
                background: linear-gradient(45deg, #e94560, #0f3460);
                color: #fff;
                font-size: 16px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .translate-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(233, 69, 96, 0.4);
            }

            .translated-output {
                margin-top: 20px;
                padding: 20px;
                background-color: rgba(255, 255, 255, 0.05);
                border-radius: 8px;
                color: #ffffff;
                font-size: 16px;
                line-height: 1.6;
                min-height: 100px;
            }
        </style>

        <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
        <script>
            function googleTranslateElementInit() {
                new google.translate.TranslateElement({pageLanguage: 'en', layout: google.translate.TranslateElement.InlineLayout.SIMPLE}, 'google_translate_element');
            }

            document.getElementById('translateBtn').addEventListener('click', function() {
                const outputText = document.getElementById('outputContainer').innerText;
                const targetLang = document.getElementById('languageSelect').value;
                
                // Create a temporary element to hold the text
                const tempElement = document.createElement('div');
                tempElement.innerHTML = outputText;
                
                // Translate the text using Google Translate API
                google.translate.TranslateElement({pageLanguage: 'auto', includedLanguages: targetLang}, tempElement);
                
                // Wait for the translation to complete
                setTimeout(() => {
                    const translatedText = tempElement.innerText;
                    document.getElementById('translatedOutput').innerText = translatedText;
                }, 1000);
            });
        </script>

    <script>
        VANTA.WAVES({
            el: "#vanta-background",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            scale: 1.00,
            scaleMobile: 1.00,
            color: 0x0f3460,
            shininess: 60.00,
            waveHeight: 20.00,
            waveSpeed: 1.50,
            zoom: 0.65
        })

        // Animate elements on load
        window.addEventListener('load', () => {
            gsap.from('h1', {duration: 1, y: -50, opacity: 0, ease: 'power3.out'});
            gsap.from('#topic-input', {duration: 1, y: 50, opacity: 0, ease: 'power3.out', delay: 0.3});
            gsap.from('#generate-btn', {duration: 1, y: 50, opacity: 0, ease: 'power3.out', delay: 0.5});
        });

        document.getElementById('generate-btn').addEventListener('click', function () {
            var topic = document.getElementById('topic-input').value;
            gsap.to('#flowchart-container', {duration: 0.5, opacity: 1, display: 'block', ease: 'power2.inOut'});
            gsap.to('#loading-animation', {duration: 0.3, opacity: 1, display: 'block', ease: 'power2.inOut'});

            fetch('/get_flowchart_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ topic: topic })
            })
                .then(response => response.json())
                .then(data => {
                    gsap.to('#loading-animation', {duration: 0.3, opacity: 0, display: 'none', ease: 'power2.inOut'});
                    if (data.error) {
                        gsap.to('#error-message', {duration: 0.5, opacity: 1, display: 'block', text: "Error: " + data.error, ease: 'power2.inOut'});
                    } else {
                        gsap.to('#error-message', {duration: 0.3, opacity: 0, display: 'none', ease: 'power2.inOut'});
                        drawFlowchart(data);
                    }
                });
        });

        function drawFlowchart(data) {
            var container = document.getElementById('flowchart');
            var nodes = new vis.DataSet(data.nodes);
            var edges = new vis.DataSet(data.edges);

            var options = {
                layout: {
                    hierarchical: {
                        direction: 'UD',
                        sortMethod: 'directed',
                        nodeSpacing: 200,
                        levelSeparation: 200,
                    }
                },
                nodes: {
                    shape: 'box',
                    font: {
                        size: 16,
                        face: 'Raleway',
                        color: '#ffffff',
                    },
                    color: {
                        background: '#e94560',
                        border: '#0f3460',
                        highlight: {
                            background: '#0f3460',
                            border: '#e94560',
                        },
                    },
                    borderWidth: 2,
                    shadow: true,
                },
                edges: {
                    smooth: {
                        type: 'cubicBezier',
                        forceDirection: 'vertical',
                        roundness: 0.4,
                    },
                    arrows: {
                        to: { enabled: true, scaleFactor: 1.2 },
                    },
                    color: '#e94560',
                    width: 2,
                    shadow: true,
                },
                interaction: {
                    dragNodes: true,
                    dragView: true,
                    zoomView: true,
                    hover: true,
                    tooltipDelay: 100,
                    hideEdgesOnDrag: false,
                },
                physics: false,
            };

            var network = new vis.Network(container, { nodes: nodes, edges: edges }, options);

            // Add interactivity to nodes
            network.on("selectNode", function (params) {
                if (params.nodes.length === 1) {
                    var node = nodes.get(params.nodes[0]);
                    gsap.to(node, {duration: 0.3, scale: 1.2, ease: 'power2.out'});
                    nodes.update(node);
                }
            });

            network.on("deselectNode", function (params) {
                params.previousSelection.nodes.forEach(nodeId => {
                    var node = nodes.get(nodeId);
                    gsap.to(node, {duration: 0.3, scale: 1, ease: 'power2.out'});
                    nodes.update(node);
                });
            });

            // Add zoom controls
            var zoomIn = document.createElement('button');
            zoomIn.innerHTML = '+';
            zoomIn.style.position = 'absolute';
            zoomIn.style.top = '10px';
            zoomIn.style.left = '10px';
            zoomIn.style.backgroundColor = '#e94560';
            zoomIn.style.color = '#ffffff';
            zoomIn.style.border = 'none';
            zoomIn.style.borderRadius = '5px';
            zoomIn.style.padding = '10px';
            zoomIn.style.cursor = 'pointer';
            zoomIn.onclick = function() { network.moveTo({scale: network.getScale() * 1.2}); };
            container.appendChild(zoomIn);

            var zoomOut = document.createElement('button');
            zoomOut.innerHTML = '-';
            zoomOut.style.position = 'absolute';
            zoomOut.style.top = '10px';
            zoomOut.style.left = '50px';
            zoomOut.style.backgroundColor = '#e94560';
            zoomOut.style.color = '#ffffff';
            zoomOut.style.border = 'none';
            zoomOut.style.borderRadius = '5px';
            zoomOut.style.padding = '10px';
            zoomOut.style.cursor = 'pointer';
            zoomOut.onclick = function() { network.moveTo({scale: network.getScale() * 0.8}); };
            container.appendChild(zoomOut);


            // Fullscreen functionality
            const flowchartContainer = document.getElementById('flowchart-container');
            const fullscreenButton = document.getElementById('fullscreen-btn');

            fullscreenButton.addEventListener('click', () => {
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    flowchartContainer.requestFullscreen();
                }
            });
        }
    </script>
</body>
</html>
